# Variant Calling with Read Mapping

Read mapping (also called **read alignment**) is one of the most widely used methods in genomics for identifying genetic variation. In this approach, sequencing reads are aligned to a reference genome, and differences between the reads and the reference indicate potential variants.  

This tutorial will guide you through:
1. Mapping long reads to the **Drosophila melanogaster** ISO1 reference genome with **minimap2**.  
2. Processing alignments with **samtools** (sorting, indexing).  
3. Calling SNPs with **FreeBayes**.  
4. Calling structural variants (SVs) with **Sniffles**.  

---

## Prerequisites

- ISO1 reference genome FASTA  
  Example: `dmel-all-chromosome-r6.63.fasta`  

- Filtered long-read FASTQ file  
  Example: `BL2969_filt.fq`  

- Installed tools:  
  - `minimap2`  
  - `samtools`  
  - `freebayes`  
  - `sniffles`

---

## Step 1. Generate Read Alignments

The first step is to align your reads to the reference genome using **minimap2**.  
We will generate a BAM file containing the alignments.

```bash
minimap2 -ax map-ont dmel-all-chromosome-r6.63.fasta BL2969_filt.fq | samtools sort -O BAM -o BL2969_iso1ref_sorted.bam -
```

- `-ax map-ont` : preset for Oxford Nanopore reads.  
- Output is piped directly to **samtools sort**, producing a sorted BAM file.  

---

## Step 2. Index the BAM File

To efficiently access and visualize the BAM file, it must be indexed.

```bash
samtools index BL2969_iso1ref_sorted.bam
```

This generates `BL2969_iso1ref_sorted.bam.bai`, which allows genome browsers (ex. IGV) to quickly access specific regions.

---

## Step 3. Call SNPs with FreeBayes

We can call **single nucleotide polymorphisms (SNPs)** from the alignment using **FreeBayes**.

```bash
freebayes -f dmel-all-chromosome-r6.63.fasta BL2969_iso1ref_sorted.bam > BL2969_freebayes.vcf
```

- Input: reference FASTA + BAM file  
- Output: a VCF file (`BL2969_freebayes.vcf`) listing SNPs and small indels.  

---

## Step 4. Call Structural Variants with Sniffles

For larger **structural variants (SVs)** such as insertions, deletions, inversions, or duplications, we use **Sniffles**.

```bash
sniffles -i BL2969_iso1ref_sorted.bam -v BL2969_sniffles.vcf
```

- Input: BAM file  
- Output: VCF file (`BL2969_sniffles.vcf`) with structural variant calls  

---

