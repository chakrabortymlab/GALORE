# Visualizing Whole-Genome Alignment (Dot Plots)


Dot plots are a powerful way to visualize whole-genome alignments and detect large structural variants (SVs).  
In this tutorial, we will learn:

1. How to generate interactive dot plots from MUMmer `.delta` files.  
2. How to interpret common patterns in dot plots (deletions, insertions, inversions, duplications).  
3. How to connect dot plot features to real biological variation.

---

## Prerequisites

- Genome assemblies for your strain(s) and the reference (ISO1).
- Alignment `.delta` file generated by **MUMmer nucmer**.  
  Example:
  ```bash
  nucmer -p BL662_vs_ISO1 dmel-all-chromosome-r6.62.fasta BL662_hifiasm_flye_scaffs.fasta
  ```

- The script [`dotplot_from_delta.py`](dotplot_from_delta.py) (provided in this repo).  
  This script uses **MUMmer `show-coords`** and **Plotly** to create interactive dot plots in HTML format.

---

## Step 1: Running the Script

The script takes a `.delta` file as input and produces an HTML dot plot.

```bash
python dotplot_from_delta.py BL662_vs_ISO1.delta --min_len 1000 --min_idy 90 --out BL662_vs_ISO1.dotplot.html
```

### Key options:
- `--min_len` : minimum alignment length to plot (default = 1000 bp).  
- `--min_idy` : minimum percent identity (default = 0).  
- `--ref_contigs` : restrict to specific reference contigs.  
- `--qry_contigs` : restrict to specific query contigs.  
- `--out` : name of the output HTML file.

---

## Step 2: Viewing the Output

The script generates an interactive HTML file, ex. `BL662_vs_ISO1.dotplot.html`.  
Open it in your browser to explore the alignments:

- **Forward alignments** (syntenic regions) = solid lines.  
- **Reverse alignments** (inversions) = dashed lines.  
- Hover over alignments to see coordinates, lengths, and % identity.

---

## Step 3: How to Interpret Dot Plots

### Perfect Synteny
A straight diagonal line indicates a perfect 1:1 match between reference and query.

![Perfect synteny example](images/perfect_synteny.png)

---

### Deletions
A gap in the diagonal indicates a deletion in one of the genomes.

![Deletion example](images/deletion.png)

---

### Insertions
Extra sequence in one genome produces a shift or offset in the dot plot.

![Insertion example](images/insertion.png)

---

### Inversions
An inversion appears as a line in the **reverse orientation** (diagonal running in the opposite direction).

![Inversion example](images/inversion.png)

---

### Duplications / Repeats
Duplications appear as **parallel lines**, indicating multiple matching regions.

![Duplication example](images/duplication.png)

---

## Exercises

1. Generate a dot plot for a strain vs ISO1.  
   Identify:
   - One **insertion**  
   - One **deletion**  
   - One **inversion**

2. Zoom into a region containing one strainâ€™s known mutation.  
   - What structural difference do you observe?  
   - Does the dot plot confirm the expected mutation?


---
