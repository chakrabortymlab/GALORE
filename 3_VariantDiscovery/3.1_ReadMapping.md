# Variant Calling with Read Mapping

One of the most traditional genomics methods for identifying genetic variation is read mapping, or read alignment. This involves determining the location of a sequenced read within a reference genome to identify differences between the sequenced individual and the reference genome. This method is reliable when short, high accuracy Illumina reads are the only sequencing data available, especially for identifying SNPs, however, it has limitations in detecting complex SVs accurately, especially in repetitive regions. Because we have long read sequencing data, we will use read mapping as a complimentary approach to whole-genome alignment.

For this module, make sure you have the ISO1 reference genome downloaded and the filtered sequencing reads FASTQs.

### Step 1: Generate Read Alignments
The standard format for storing large nucleotide sequence alignments against a reference genome is called a sequence alignment file (SAM). It contains information about the alignment of DNA or RNA sequences (reads) against a reference genome. 

SAM files can be compressed into binary format (BAM) for efficient storage and processing. BAM files are compressed and indexed, making them suitable for large-scale genomic data analysis.

To generate a BAM file containing alignment of our samples reads to the Drosophila ISO1 reference genome, we will use a program called minimap2. 
In this example, we map Oxford Nanopore reads to the reference using **minimap2** and sort the alignments using **samtools**:

```bash

minimap2 -ax map-ont dmel-all-chromosome-r6.63.fasta BL2969_filt.fq | samtools sort -@48 -O BAM -o BL2969_iso1ref_sorted.bam -

```

Variant callers such as **Delly** or **Sniffles** can then be used on the resulting BAM file to identify structural variants.

### Step 2. Sort and index SAM file

### Step 3. Use Freebayes to call SNPs from read alignment

### Step 4. Use SnifflesSV to call SVs from read alignment
