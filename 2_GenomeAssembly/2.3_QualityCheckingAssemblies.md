# Quality Checking Genome Assemblies


Once we've generated a de novo genome assembly, it's essential to evaluate its quality before using it in downstream analyses.

Genome assembly quality is typically assessed using three major criteria:
1. **Contiguity**
2. **Completeness**
3. **Accuracy**

---

## 1. Contiguity

With high sequencing coverage and long reads, an ideal genome assembly would represent each chromosome as a single continuous sequence (a *contig*). However, most assemblies contain gaps due to challenges in assembling repetitive regions. These unresolved gaps can limit our understanding of certain genomic regions and impact downstream analyses.

To quantify contiguity, we use metrics such as:

- **N50**: The length such that 50% of the genome is contained in contigs of that length or longer.  
- **L50**: The number of contigs that collectively make up 50% of the genome.

A higher N50 and lower L50 indicate a less fragmented and more contiguous genome assembly.

We can compute these metrics using tools like **QUAST**:

```bash
quast -o strain_contigs_quast assembly.fa

- `-o`: output directory name
- `assembly.fa`: the genome assembly in FASTA format
```

After running QUAST, navigate to the output directory and view the report with:
less strain_contigs_quast/report.txt

Example of QUAST output: 
```text
Assembly                    drosophila_genome
# contigs (>= 0 bp)         22                              
# contigs (>= 1000 bp)      22                              
# contigs (>= 5000 bp)      22                              
# contigs (>= 10000 bp)     22                              
# contigs (>= 25000 bp)     22                              
# contigs (>= 50000 bp)     18                              
Total length (>= 0 bp)      135732031                       
Total length (>= 1000 bp)   135732031                       
Total length (>= 5000 bp)   135732031                       
Total length (>= 10000 bp)  135732031                       
Total length (>= 25000 bp)  135732031                       
Total length (>= 50000 bp)  135587543                       
# contigs                   22                              
Largest contig              28188642                        
Total length                135732031                       
GC (%)                      42.26                           
N50                         21823827                        
N75                         12649029                        
L50                         3                               
L75                         5                               
# N's per 100 kbp           0.00
```
This example shows a D. melanogaster assembly with 22 contigs and a total length of ~135.7 Mb. The N50 is 21.8 Mb and L50 is 3. For comparison, the reference strain ISO1 has an N50 of 21.5 Mb and L50 of 3, suggesting this assembly has comparable contiguity to the reference genome — a promising result!

## 2. Completeness
Completeness measures how much of the expected gene content is captured in the assembly. If essential genes are missing, it could compromise functional and evolutionary analyses.

BUSCO (Benchmarking Universal Single-Copy Orthologs) is commonly used to assess completeness. It searches for conserved, single-copy genes expected to be present in a given lineage (ex. the order *Diptera* for *Drosophila*).

To run BUSCO:

```bash
busco -i scaffs.fa -m genome -l diptera_odb10 -c 24 -o dip_busco
```
-i: input FASTA file (your assembly)

-m genome: mode set to genome analysis

-l diptera_odb10: lineage dataset for Diptera

-c: number of CPU threads

-o: output directory name

A completeness score above 95% is generally good; for model organisms like D. melanogaster, we expect values above 98%.

## 3. Accuracy
Accuracy refers to how well the assembled sequence reflects the true genomic sequence. While this tutorial won’t include hands-on accuracy evaluation, here are common methods:

- Read Mapping: Align the original sequencing reads back to the assembly. High alignment rates and low mismatch rates indicate higher accuracy.

- Hi-C contact maps: Hi-C sequencing is used to map the 3D structure of the genome. It can be used to examine long-range interactions in the genome to see if they support the contiguity and orientation of contigs.


Although we won’t perform these steps here, accuracy becomes increasingly important when resolving fine scale features such as single nucleotide polymorphisms (SNPs) and structural variants.

### TODO: Evaluate quality of 11 *D. melanogaster* genomes
1. Run QUAST and BUSCO on each strain genome assembly
2. Using metrics like N50, L50, and Complete BUSCO score, how do the genome assemblies compare to eachother? 
